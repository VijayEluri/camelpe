<?xml version="1.0" encoding="UTF-8"?>
<application xmlns="http://geronimo.apache.org/xml/ns/j2ee/application-2.0"
	xmlns:sys="http://geronimo.apache.org/xml/ns/deployment-1.2"
	application-name="OrderPlacement">

	<sys:environment>
		<sys:moduleId>
			<sys:groupId>${geronimo.moduleId.groupId}</sys:groupId>
			<sys:artifactId>${geronimo.moduleId.artifactId}</sys:artifactId>
			<sys:version>${geronimo.moduleId.version}</sys:version>
			<sys:type>${geronimo.moduleId.type}</sys:type>
		</sys:moduleId>
		<sys:hidden-classes>
			<sys:filter>org.springframework</sys:filter>
			<sys:filter>org.hibernate</sys:filter>
			<sys:filter>org.aspectj</sys:filter>
			<sys:filter>org.aopalliance</sys:filter>
			<sys:filter>antlr</sys:filter>
			<sys:filter>javassist</sys:filter>
		</sys:hidden-classes>
	</sys:environment>

	<module>
		<connector>tranql-connector-postgresql-xa-1.1.rar</connector>
		<alt-dd>META-INF/geronimo-postgresql-ds.xml</alt-dd>
	</module>

	<module>
		<connector>orderplacement.jee.integrationra-1.0-SNAPSHOT.rar</connector>
		<alt-dd>META-INF/geronimo-integrationra.xml</alt-dd>
	</module>

	<module>
		<ejb>orderplacement.jee.ejb-1.0-SNAPSHOT.jar</ejb>
		<openejb-jar xmlns="http://openejb.apache.org/xml/ns/openejb-jar-2.2"
			xmlns:naming="http://geronimo.apache.org/xml/ns/naming-1.2">

			<sys:environment>
				<sys:moduleId>
					<sys:groupId>com.acme.orderplacement.jee
					</sys:groupId>
					<sys:artifactId>orderplacement.jee.ejb
					</sys:artifactId>
					<sys:version>1.0-SNAPSHOT</sys:version>
					<sys:type>jar</sys:type>
				</sys:moduleId>
			</sys:environment>

			<enterprise-beans>
				<session>
					<ejb-name>ItemStorageServiceEJB</ejb-name>
					<naming:resource-ref>
						<naming:ref-name>jdbc/OrderPlacementDS
						</naming:ref-name>
						<naming:resource-link>jdbc/com/acme/OrderPlacementDS
						</naming:resource-link>
					</naming:resource-ref>
				</session>
			</enterprise-beans>
		</openejb-jar>
	</module>

	<module>
		<web>orderplacement.jee.ws-1.0-SNAPSHOT.war</web>
		<web-app xmlns="http://geronimo.apache.org/xml/ns/j2ee/web-2.0.1">
			<sys:environment>
				<sys:moduleId>
					<sys:groupId>com.acme.orderplacement.jee
					</sys:groupId>
					<sys:artifactId>orderplacement.jee.ejb
					</sys:artifactId>
					<sys:version>1.0-SNAPSHOT</sys:version>
					<sys:type>war</sys:type>
				</sys:moduleId>
			</sys:environment>
			<context-root>/orderplacement</context-root>
		</web-app>
	</module>

	<ext-module>
		<connector>com/acme/jms/StateChangeEventsRA</connector>
		<external-path>
			<sys:groupId>org.apache.geronimo.modules</sys:groupId>
			<sys:artifactId>geronimo-activemq-ra</sys:artifactId>
			<sys:version>2.1.3</sys:version>
		</external-path>
		<connector xmlns="http://geronimo.apache.org/xml/ns/j2ee/connector-1.2">
			<resourceadapter>
				<!--how to connect to the JMS Server-->
				<resourceadapter-instance>
					<resourceadapter-name>com/acme/jms/OrderplacementJMSResources</resourceadapter-name>
					<config-property-setting name="ServerUrl">tcp://localhost:61616</config-property-setting>
					<config-property-setting name="UserName">not needed</config-property-setting>
					<config-property-setting name="Password">not needed</config-property-setting>
					<workmanager xmlns="http://geronimo.apache.org/xml/ns/naming-1.2">
						<gbean-link>DefaultWorkManager</gbean-link>
					</workmanager>
				</resourceadapter-instance>

				<!--defines a ConnectionFactory-->
				<outbound-resourceadapter>
					<connection-definition>
						<connectionfactory-interface>javax.jms.ConnectionFactory</connectionfactory-interface>
						<connectiondefinition-instance>
							<name>com/acme/jms/TopicConnectionFactory</name>
							<implemented-interface>javax.jms.TopicConnectionFactory</implemented-interface>
							<connectionmanager>
								<xa-transaction>
									<transaction-caching />
								</xa-transaction>
								<single-pool>
									<max-size>10</max-size>
									<min-size>0</min-size>
									<blocking-timeout-milliseconds>5000</blocking-timeout-milliseconds>
									<idle-timeout-minutes>0</idle-timeout-minutes>
									<match-one />
								</single-pool>
							</connectionmanager>
						</connectiondefinition-instance>
					</connection-definition>
				</outbound-resourceadapter>
			</resourceadapter>

			<adminobject>
				<adminobject-interface>javax.jms.Topic</adminobject-interface>
				<adminobject-class>org.activemq.message.ActiveMQTopic</adminobject-class>
				<adminobject-instance>
					<message-destination-name>com/acme/jms/StateChangeEventsTopic</message-destination-name>
					<config-property-setting name="PhysicalName">com/acme/jms/StateChangeEventsTopic</config-property-setting>
				</adminobject-instance>
			</adminobject>
		</connector>
	</ext-module>

</application>

